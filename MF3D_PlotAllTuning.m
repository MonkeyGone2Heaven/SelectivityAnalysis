
%========================= MF3D_PlotAllTuning.m ===========================
% Plot single cell tuning to head orientation, stereoscopic depth and 
% facial expression based on the first week of pilot data for all monkeys.
%
%==========================================================================

Subject     = 'Matcha';
Output      = 'gif';

switch Subject
    case 'Avalanche'
        Dates      	= {'20160627','20160628','20160629','20160630','20160701','20160712','20160713','20160714','20160715'};
        ExpType     = [1,1,2,3,3,4,4,5,5];
        Channels  	= { [3,3,23,25,26,45,51,54,58,63,71,76,78,83,91,101,104,110,113,116,117,118,120,124,125],...
                        [3,19,23,23,45,62,63,76,87,94,100,117],...
                        [3,23,62,63,76,87,94,100,117],...
                        [3,17,62,76,87,100,117],...
                        [3,3,17,19,23,23,24,25,26,28,45,50,51,56,58,59,59,61,62,63,63,63,65,65,66,68,70,71,72,73,74,74,75:116,117,120,123:128],...
                        [76,78,89,90,91,96,101,107,109,117,119,120,123,128],...
                        [71,90,91,96,125,128],...
                        [67,71,76,89,91,101],...
                        [67,71,76,89,91,101]};
        Cell        = { [1,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1],...
                        [1,1,1,2,1,1,1,1,1,1,1,2],...
                        [1,1,1,1,1,1,1,1,1,1,1],...
                        [1,1,1,1,1,1,1,1,1,1,1,1,1],...
                        [1,2,1,1,1,2,1,1,1,1,1,1,1,1,1,1,2,1,1,1,2,3,1,3,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1],...
                        [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],...
                        [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],...
                        [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],...
                        [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]};

    case 'Matcha';
        Dates       = {'20160613','20160614','20160615','20160616','20160617','20160719','20160720','20160721','20160722'};
        ExpType     = [1,1,2,3,3,4,4,4,5];
        Channels    = { [2,3,5,9,16,17,19,21,22,25,26,32,44,48,59,61],...
                        [2,3,5,9,16,17,19,21,22,25,26,32,44,48,59,61],...
                        [2,4,5,8,9,22,26,32,33,44,48],...
                        [2,5,5,8,9,19,22,26,29,40,44,48,64],...
                        [2,5,5,8,9,19,22,26,29,40,44,48,64],...
                        [8,37,44,48,49],...
                        [5,8,9,11,25,64],...
                        [2,5,8,9,17,25,44,51,54]};
     	Cell        = { [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],...
                        [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],...
                        [2,2,1,1,1,1,1,1,1,1,1],...
                        [2,1,2,1,1,1,1,1,1,1,1,1,1],...
                        [2,1,2,1,1,1,1,1,1,1,1,1,1],...
                        [1,1,1,1,1,1],...
                        [1,1,1,1,1,1,1,1],...
                        [1,1,1,1,1,1,1,1,1,1,1,1,1]};
        
    case 'Spice'
      	Dates       = {'20160620','20160621','20160622','20160623','20160624'};
        Channels    = { [24,35,39,43,44,49,53,59],...
                        [1,5,11,43],...
                        [],...
                        [1,5,8,19,28,43],...
                        [21,27,43]};
        Cell        = { [1,2,2,1,2,1,1,2],...
                        [1,1,1,1],...
                        [1,1,1,1,1,1,1,1],...
                        [1,2,1,1,1,1,1,1],...
                        [1,1,1,1]};
        
    otherwise
        error('unknown subject ''%s''!\n', Subject)
end

%=================== Loop through cells
for d = 1:numel(Channels)
    Tally(d) = numel(Channels{d}); 
end
TotalCells   	= sum(Tally);
CurrentCell 	= 1;
wbh = waitbar(0);
for d = 8%1:numel(Dates)
    if ~iscell(Cell) || isempty(Cell{d})
        Cell{d}	= ones(size(Channels{d}));
    end
    for ch = 1:numel(Channels{d})
%         waitbar(CurrentCell/TotalCells, wbh, sprintf('Plotting neural tuning for %s %s - channel %d (%d/%d)...', Subject, Dates{d}, Channels{d}(ch),  CurrentCell, TotalCells));
        if d <= 3
            MF3D_PlotResponses_Orientations(Subject, Dates{d}, Channels{d}(ch), Cell{d}(ch), Output);
        elseif ismember(d,[4,5])
            MF3D_PlotResponses_Expressions(Subject, Dates{d}, Channels{d}(ch), Cell{d}(ch), Output);
            MF3D_PlotResponses_Depth(Subject, Dates{d}, Channels{d}(ch), Cell{d}(ch), Output);
        elseif ismember(d,[6,7,8])
            MF3D_PlotResponses_Identities(Subject, Dates{d}, Channels{d}(ch), Cell{d}(ch), Output);
%         elseif ismember(d,[8,9])  
%             MF3D_PlotResponses_Orientations(Subject, Dates{d}, Channels{d}(ch), Cell{d}(ch), Output);
        end
        CurrentCell = CurrentCell+1;
        close all
    end
end
delete(wbh);